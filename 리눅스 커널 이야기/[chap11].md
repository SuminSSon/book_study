# Chap 11. I/O 작업이 지나가는 관문, I/O 스케줄러

I/O 스케줄러는 상대적으로 접근 속도가 느린 디스크에 대한 성능을 최대화하기 위해 구현된 커널의 일부분
- 병합: 헤드의 움직임을 최소화하기 위해 디스크로의 명령 전달을 최소화하고 성능 향상
- 정렬: 여러 개의 요청을 섹터 순서대로 재배치

/sys/block/<block device>/queue/scheduler에서 현재 사용하는 스케줄러와 사용 가능한 I/O 스케줄러 정보를 볼 수 있으며, echo 명령을 통해 변경 가능하다.

cfq I/O 스케줄러는 I/O 요청을 일으키는 각각의 프로세스별로 요청 큐를 할당하고 특정 타임 슬라이스 동안 해당 큐의 I/O들을 처리하도록 만들음
큐와 큐 사이를 이동할 때는 시간이 소요되며, 임의 접근이 많아서 큐끼리 접근하는 영역이 가깝지 않을 경우 성능 저하 발생.
하지만 각각의 프로세스별로 시간이 주어지기 때문에 거의 대등하기 I/O 요청 처리.

deadline I/O 스케줄러는 I/O 요청을 발생 시간을 기준으로 관리함.
기본적으로는 섹터를 기준으로 정렬된 큐에서 요청을 꺼내서 블록 디바이스로 넘기지만, 특정 I/O 요청이 할당된 시간 이상으로 지연될 경우 중간에 해당 I/O 요청을 처리하도록 동작함.
다수의 프로세스들이 I/O 요청을 처리하도록 동작함.
다수의 프로세스들이 I/O 요청을 만들어 내며, 그 중 몇몇 개의 프로세스가 많은 I/O 요청을 일으켜서 빨리 처리되어야 하는 경우, 또는 대부분 데이터베이스나 파일 서버 용도로 사용하는 서버에 적합한 I/O 스케줄러

noop I/O 스케줄러는 I/O 요청을 따로 정렬하지 않지만 병합 작업은 진행함.
임의 접근에도 헤드의 이동 시간이 포함되지 않은 SSD와 같은 플래시 기반의 디스크에 적합한 I/O 스케줄러.
임의 접근 시에도 헤드를 이동시키지 않기 때문에 접근하는 섹터별로 정렬할 필요가 없어서 소요되는 시간이 줄어드는, 플래시 메모리 기반의 디스크에 더 적합한 I/O 스케줄러다.

iotop 명령을 통해서 현재 시스템에서 I/O를 일으키는 프로세스가 얼마나 되는지 살펴볼 수 있다. cfq는 쓰레드가 아닌 프로세스 별로 큐를 할당하기 대문에 -P 옵션을 붙여서 사용하는 것이 좋다.